<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta name="format-detection" content="telephone=no,email=no,address=no">
    <!-- 视口适配（移动端常考） -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>移动端自适应常考题目示例</title>
    <style>
        /* 1) 媒体查询：Mobile First（常考断点） */
        :root {
            --gap: 16px;
        }

        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        }

        .container {
            padding: var(--gap);
        }

        .card {
            background: #f6f7f9;
            border-radius: 12px;
            padding: var(--gap);
            margin-bottom: var(--gap);
        }

        /* 默认手机样式 */
        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--gap);
        }

        /* 平板（>=768px） */
        @media (min-width: 768px) {
            .grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* 桌面（>=1024px） */
        @media (min-width: 1024px) {
            .grid {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }

        /* 2) vw/vh 适配（等比例缩放） */
        .banner {
            width: 100vw;
            height: 40vh;
            /* 注意 iOS 100vh 的地址栏问题，见下文 svh */
            background: linear-gradient(135deg, #79c, #4bd);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 3) iOS 刘海安全区域（Safe Area） */
        .safeArea {
            padding-top: env(safe-area-inset-top);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
            padding-bottom: env(safe-area-inset-bottom);
            background: #eef;
        }

        /* 4) 1px 物理像素问题（发丝线） */
        .hairline {
            position: relative;
            padding-top: 12px;
            margin-top: var(--gap);
        }

        .hairline::before {
            content: "";
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            height: 1px;
            background: #ddd;
            transform: scaleY(0.5);
            /* 在高 DPR 设备上接近 1 物理像素 */
            transform-origin: 50% 0;
        }

        /* 5) 小屏（竖屏）表单优化 */
        .form {
            display: flex;
            gap: 8px;
        }

        .form input {
            flex: 1 1 auto;
            min-width: 0;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }

        .form button {
            flex: 0 0 auto;
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            background: #48c;
            color: #fff;
        }

        /* 6) 全屏适配新单位（解决 100vh 受地址栏影响，现代浏览器支持） */
        .fullHeight {
            min-height: 100svh;
            /* Small Viewport Height，避免地址栏收缩导致跳变 */
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fef6e4;
        }
    </style>
</head>

<body>
    <div class="banner">vw/vh 适配横幅</div>

    <div class="container">
        <div class="card safeArea">
            <h3>iOS 安全区域</h3>
            <p>使用 env(safe-area-inset-*) 处理刘海/底部 Home 指示条的内边距。</p>
        </div>

        <div class="card hairline">
            <h3>1px 发丝线</h3>
            <p>通过 transform: scaleY(0.5) 实现接近 1 物理像素的分割线（DPR>1 设备）。</p>
        </div>

        <div class="card">
            <h3>媒体查询栅格（Mobile First）</h3>
            <div class="grid">
                <div class="card">块 1</div>
                <div class="card">块 2</div>
                <div class="card">块 3</div>
            </div>
        </div>

        <div class="card">
            <h3>响应式图片（srcset + sizes）</h3>
            <picture>
                <source srcset="banner-1024.jpg 1024w, banner-768.jpg 768w, banner-480.jpg 480w"
                    sizes="(min-width:1024px) 1024px, (min-width:768px) 768px, 100vw">
                <img src="banner-480.jpg" alt="响应式图片示例" style="width:100%; border-radius: 12px;">
            </picture>
            <p>常考点：根据设备宽度自动选择合适尺寸，节省带宽、提升清晰度。</p>
        </div>

        <div class="card">
            <h3>表单与软键盘适配</h3>
            <div class="form">
                <input type="text" placeholder="输入内容..." />
                <button type="button">提交</button>
            </div>
            <p>要点：flex 布局、min-width:0 防止内容撑破，避免 fixed 元素被键盘遮挡。</p>
        </div>

        <div class="card fullHeight">
            <h3>使用 100svh 适配全屏</h3>
        </div>
    </div>

    <script>
        /**
         * setRootFontSize
         * 函数功能：REM 适配，按视口宽度设置根字体大小，实现等比缩放（10rem = 设计稿宽）
         * 使用场景：移动端常考“flexible/rem”方案，配合把 px 转 rem（构建阶段可用 postcss-pxtorem）。
         * @param {number} designWidth 设计稿宽度（如 375 或 750）
         * @returns {void}
         */
        function setRootFontSize(designWidth) {
            var docEl = document.documentElement;
            var width = docEl.clientWidth || window.innerWidth;
            // 根字体大小：以 10 为基数更易换算（10rem = 设计稿宽），即 1rem = 设计稿宽度的 1/10
            var rootFontSize = (width / designWidth) * 10;
            docEl.style.fontSize = rootFontSize + 'px';
        }

        /**
         * initResponsive
         * 函数功能：初始化移动端常用自适应配置（REM 设置、被动事件监听优化）
         * @returns {void}
         */
        function initResponsive() {
            // 以 375 宽设计稿为例（iPhone 常见宽度）；如 750 则换成 750
            setRootFontSize(375);
            window.addEventListener('resize', function () { setRootFontSize(375); }, { passive: true });
            window.addEventListener('orientationchange', function () { setRootFontSize(375); }, { passive: true });
            // 滚动与触摸的性能优化（常考：passive 事件监听）
            document.addEventListener('touchmove', function () { /* 业务逻辑 */ }, { passive: true });
        }

        initResponsive();

        /**
         * scrollIntoViewIfNeeded
         * 函数功能：输入框聚焦时滚动到可视区域，缓解软键盘遮挡（常考：iOS 输入框适配）
         * @param {HTMLElement} el 需要滚动显示的元素
         * @returns {void}
         */
        function scrollIntoViewIfNeeded(el) {
            if (!el) return;
            setTimeout(function () {
                // 部分浏览器存在键盘弹出后窗口高度变化延迟，用延时处理
                el.scrollIntoView({ block: 'center', behavior: 'smooth' });
            }, 100);
        }
        // 示例：统一为所有输入框绑定
        document.addEventListener('focusin', function (e) {
            if (e.target && e.target.tagName === 'INPUT') {
                scrollIntoViewIfNeeded(e.target);
            }
        });
    </script>

    <!-- 面试常考知识点清单（速览）
    1) meta viewport：width=device-width, initial-scale=1；禁用缩放视需求设置 maximum-scale=1, user-scalable=no
    2) 单位选择：vw/vh 等比例适配；rem 按根字体缩放（构建用 pxtorem/px2vw）
    3) 媒体查询断点：Mobile First（>=768、>=1024）；栅格/流式布局
    4) 1px 问题：高 DPR 下发丝线（transform scale、0.5px iOS、边框图像/阴影）
    5) Safe Area：env(safe-area-inset-*) 处理刘海屏/底部 Home 区
    6) 响应式图片：<picture> + srcset + sizes；避免加载过大图片
    7) 事件优化：passive 监听、touch-action、overscroll-behavior
    8) 100vh Bug：使用 100svh/lvh/dvh 解决地址栏遮挡问题（现代浏览器支持）
  -->
</body>

</html>